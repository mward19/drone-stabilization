(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46156,       1208]
NotebookOptionsPosition[     43688,       1156]
NotebookOutlinePosition[     44350,       1179]
CellTagsIndexPosition[     44307,       1176]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["c", "i"], " ", "represents", " ", 
     SubscriptBox["u", "i"]}], ",", " ", 
    RowBox[{"which", " ", "is", " ", "the", " ", "control"}]}], 
   TraditionalForm]],ExpressionUUID->"82cb0813-45bc-4d70-a16c-9155e1098a1b"],
 "."
}], "Text",
 CellChangeTimes->{{3.9532206846735077`*^9, 3.95322070135248*^9}, {
  3.9532208711768103`*^9, 
  3.953220884739052*^9}},ExpressionUUID->"e3ec070d-361b-4d04-bfbc-\
e7027db82d39"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"control", "=", 
  RowBox[{"Array", "[", 
   RowBox[{"c", ",", "4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9532223750087347`*^9, 3.953222390598321*^9}, {
  3.953222433392033*^9, 3.953222438193593*^9}, {3.953222487386917*^9, 
  3.953222509957996*^9}, {3.953222557319927*^9, 3.9532225645764427`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"1aba52b7-e0ff-4dc5-9f66-147c5c9af052"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"c", "[", "1", "]"}], ",", 
   RowBox[{"c", "[", "2", "]"}], ",", 
   RowBox[{"c", "[", "3", "]"}], ",", 
   RowBox[{"c", "[", "4", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.95322239078732*^9, 3.953222435576371*^9, {3.953222489509083*^9, 
   3.953222510223935*^9}, 3.9532225599790297`*^9, 3.953222599132657*^9, 
   3.953222869013344*^9, 3.9532231857095222`*^9, 3.9532252589913073`*^9, 
   3.9532253821212673`*^9, 3.953666119866537*^9, {3.953668874048028*^9, 
   3.953668895552043*^9}, 3.9536718523464813`*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"18742f15-3f08-4a83-8ce2-445a00ce0a5b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Sigma]Dot", "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        FractionBox["L", "inerx"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "3", "]"}], "+", 
          RowBox[{"c", "[", "4", "]"}], "-", 
          RowBox[{"c", "[", "1", "]"}], "-", 
          RowBox[{"c", "[", "2", "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["L", "inery"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], "+", 
          RowBox[{"c", "[", "3", "]"}], "-", 
          RowBox[{"c", "[", "2", "]"}], "-", 
          RowBox[{"c", "[", "4", "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", "inerz"], "\[Lambda]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "2", "]"}], "+", 
          RowBox[{"c", "[", "3", "]"}], "-", 
          RowBox[{"c", "[", "1", "]"}], "-", 
          RowBox[{"c", "[", "4", "]"}]}], ")"}]}]},
      {
       RowBox[{
        FractionBox["1", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}]}]},
      {
       RowBox[{
        RowBox[{"q", " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
        RowBox[{"r", " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         FractionBox["1", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}]}], "+", "p"}]},
      {
       RowBox[{"g", " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]},
      {
       RowBox[{" ", 
        RowBox[{"g", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], 
         RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]},
      {
       RowBox[{" ", 
        RowBox[{
         RowBox[{"g", " ", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}]}], " ", "-", " ", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"Total", "[", "control", "]"}], ")"}], "m"]}]}]},
      {
       RowBox[{
        RowBox[{"u", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
        RowBox[{"v", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", "-", " ", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]", "]"}], 
            RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"w", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]", "]"}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], 
            RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"u", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], 
         RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
        RowBox[{"v", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]", "]"}], 
            RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"w", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Phi]", "]"}], 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], 
            RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], 
            RowBox[{"Cos", "[", "\[Psi]", "]"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"u", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
        RowBox[{"v", " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", " ", 
        RowBox[{"w", " ", 
         RowBox[{"Cos", "[", "\[Phi]", "]"}], 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.953219564351747*^9, 3.95321970203693*^9}, {
   3.953219754918496*^9, 3.953220060321097*^9}, {3.953220101757901*^9, 
   3.953220340814642*^9}, {3.953220400657641*^9, 3.953220450958323*^9}, 
   3.95322052494699*^9, {3.9532205793906527`*^9, 3.953220579438842*^9}, {
   3.9532206138899527`*^9, 3.953220668740432*^9}, {3.953220790376074*^9, 
   3.953220793163904*^9}, {3.9532210781147633`*^9, 3.953221078190365*^9}, {
   3.9532211187056704`*^9, 3.9532211352571363`*^9}, 3.953221653084914*^9, {
   3.953222440384687*^9, 3.9532225076654654`*^9}, {3.953222801988534*^9, 
   3.95322285246541*^9}, {3.953223205156506*^9, 3.953223205429472*^9}, {
   3.95365880702806*^9, 3.953658807736642*^9}, {3.95365885240413*^9, 
   3.953658855714801*^9}, {3.953658888609494*^9, 3.9536588887366734`*^9}, {
   3.953658979123904*^9, 3.953658980672017*^9}, {3.953671535911477*^9, 
   3.9536715573169737`*^9}, {3.9536718241104803`*^9, 3.9536718437261257`*^9}},
 
 CellLabel->"In[24]:=",ExpressionUUID->"e2d9606a-5b72-43d1-9896-da17b6cc5c55"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.953220233863447*^9, 3.953220237772008*^9}, {
  3.953221055445107*^9, 3.953221059060112*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"3c34ee0f-76a5-44a0-9d24-e40ffd0dd8c6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"{", 
    RowBox[{
    "p", ",", " ", "q", ",", " ", "r", ",", " ", "\[Psi]", ",", " ", 
     "\[Theta]", ",", " ", "\[Phi]", ",", " ", "u", ",", " ", "v", ",", " ", 
     "w", ",", " ", "x", ",", " ", "y", ",", " ", "z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"costate", "=", 
  RowBox[{"Array", "[", 
   RowBox[{"\[Rho]", ",", "12"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.953220707820855*^9, 3.9532207489876127`*^9}, {
  3.953220809787846*^9, 3.9532209274854717`*^9}, {3.9532223542065372`*^9, 
  3.953222360124341*^9}, {3.9532226992829037`*^9, 3.953222703584073*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"c3378d7c-7b96-40ee-baa5-ffbd49d0d95c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Rho]", "[", "1", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "2", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "3", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "4", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "5", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "6", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "7", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "8", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "9", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "10", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "11", "]"}], ",", 
   RowBox[{"\[Rho]", "[", "12", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.953222360553347*^9, 3.953222517789764*^9, 3.953222599271776*^9, 
   3.9532228691381407`*^9, {3.953223185797152*^9, 3.953223209057173*^9}, 
   3.953225259124566*^9, 3.9532253822656193`*^9, {3.953666124826355*^9, 
   3.953666126730506*^9}, {3.953668880535371*^9, 3.953668895686474*^9}, 
   3.953671852454406*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"bd012df3-7c10-41d7-a4c8-b97c1b2ae462"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"H", "=", 
  RowBox[{
   RowBox[{"costate", ".", "\[Sigma]Dot"}], " ", "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Total", "[", 
      SuperscriptBox["control", "2"], "]"}], "+", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       SuperscriptBox["\[Psi]", "2"], ")"}]}], "+", 
     RowBox[{"\[Beta]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Theta]", "2"], "+", 
        SuperscriptBox["\[Phi]", "2"]}], ")"}]}], "+", 
     RowBox[{"\[Gamma]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}]}], "+", 
     RowBox[{"\[Delta]", " ", 
      SuperscriptBox["z", "2"]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.95322080065412*^9, 3.953220801026347*^9}, {
   3.953220930409202*^9, 3.9532210445888767`*^9}, {3.9532210928268747`*^9, 
   3.9532211007752533`*^9}, {3.95322126764142*^9, 3.953221272533573*^9}, {
   3.95322252069382*^9, 3.953222578010503*^9}, 3.953223167177011*^9, {
   3.953225228717338*^9, 3.95322523648895*^9}, {3.953225317615572*^9, 
   3.953225347545434*^9}, 3.953225434015624*^9, {3.953666130471734*^9, 
   3.953666141726798*^9}, {3.9536688438590527`*^9, 3.9536688507861*^9}, 
   3.9536688908286133`*^9},
 CellLabel->"In[28]:=",ExpressionUUID->"f5e6ae14-8415-46c7-9ffb-80042703e644"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}], " ", "\[Gamma]"}], ")"}]}], "-", 
   RowBox[{
    SuperscriptBox["z", "2"], " ", "\[Delta]"}], "-", 
   RowBox[{"\[Beta]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Theta]", "2"], "+", 
      SuperscriptBox["\[Phi]", "2"]}], ")"}]}], "-", 
   RowBox[{"\[Alpha]", " ", 
    SuperscriptBox["\[Psi]", "2"]}], "-", 
   SuperscriptBox[
    RowBox[{"c", "[", "1", "]"}], "2"], "-", 
   SuperscriptBox[
    RowBox[{"c", "[", "2", "]"}], "2"], "-", 
   SuperscriptBox[
    RowBox[{"c", "[", "3", "]"}], "2"], "-", 
   SuperscriptBox[
    RowBox[{"c", "[", "4", "]"}], "2"], "+", 
   FractionBox[
    RowBox[{"L", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", "[", "1", "]"}]}], "-", 
       RowBox[{"c", "[", "2", "]"}], "+", 
       RowBox[{"c", "[", "3", "]"}], "+", 
       RowBox[{"c", "[", "4", "]"}]}], ")"}], " ", 
     RowBox[{"\[Rho]", "[", "1", "]"}]}], "inerx"], "+", 
   FractionBox[
    RowBox[{"L", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", "[", "1", "]"}], "-", 
       RowBox[{"c", "[", "2", "]"}], "+", 
       RowBox[{"c", "[", "3", "]"}], "-", 
       RowBox[{"c", "[", "4", "]"}]}], ")"}], " ", 
     RowBox[{"\[Rho]", "[", "2", "]"}]}], "inery"], "+", 
   FractionBox[
    RowBox[{"\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"c", "[", "1", "]"}]}], "+", 
       RowBox[{"c", "[", "2", "]"}], "+", 
       RowBox[{"c", "[", "3", "]"}], "-", 
       RowBox[{"c", "[", "4", "]"}]}], ")"}], " ", 
     RowBox[{"\[Rho]", "[", "3", "]"}]}], "inerz"], "+", 
   RowBox[{
    RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
      RowBox[{"q", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
    RowBox[{"\[Rho]", "[", "4", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q", " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
    RowBox[{"\[Rho]", "[", "5", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "+", 
      RowBox[{
       RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", 
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{"q", " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Rho]", "[", "6", "]"}]}], "+", 
   RowBox[{"g", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "7", "]"}]}], "+", 
   RowBox[{"g", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "8", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], "+", 
         RowBox[{"c", "[", "2", "]"}], "+", 
         RowBox[{"c", "[", "3", "]"}], "+", 
         RowBox[{"c", "[", "4", "]"}]}], "m"]}], "+", 
      RowBox[{"g", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
    RowBox[{"\[Rho]", "[", "9", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"u", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
      RowBox[{"v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"u", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Psi]", "]"}]}], "+", 
      RowBox[{"w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Psi]", "]"}]}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"\[Rho]", "[", "11", "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "w"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
      RowBox[{"u", " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "-", 
      RowBox[{"v", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ")"}], " ", 
    RowBox[{"\[Rho]", "[", "12", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.953668892544949*^9, 3.953668895731618*^9}, 
   3.9536718524821663`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"4cde519c-5093-450a-b47c-47a90fb9e0a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"optControl", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Grad", "[", 
      RowBox[{"H", ",", "control"}], "]"}], "==", "0"}], ",", "control"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.953222611652987*^9, 3.953222624571991*^9}, {
  3.953222661570036*^9, 3.953222662263989*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"7a871b14-2814-4f15-824c-c42388d84e9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "inery"}], " ", "inerz", " ", "L", " ", "m", " ", 
        RowBox[{"\[Rho]", "[", "1", "]"}]}], "+", 
       RowBox[{"inerx", " ", "inerz", " ", "L", " ", "m", " ", 
        RowBox[{"\[Rho]", "[", "2", "]"}]}], "-", 
       RowBox[{"inerx", " ", "inery", " ", "m", " ", "\[Lambda]", " ", 
        RowBox[{"\[Rho]", "[", "3", "]"}]}], "-", 
       RowBox[{"inerx", " ", "inery", " ", "inerz", " ", 
        RowBox[{"\[Rho]", "[", "9", "]"}]}]}], 
      RowBox[{"2", " ", "inerx", " ", "inery", " ", "inerz", " ", "m"}]]}], 
    ",", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "inery"}], " ", "inerz", " ", "L", " ", "m", " ", 
        RowBox[{"\[Rho]", "[", "1", "]"}]}], "-", 
       RowBox[{"inerx", " ", "inerz", " ", "L", " ", "m", " ", 
        RowBox[{"\[Rho]", "[", "2", "]"}]}], "+", 
       RowBox[{"inerx", " ", "inery", " ", "m", " ", "\[Lambda]", " ", 
        RowBox[{"\[Rho]", "[", "3", "]"}]}], "-", 
       RowBox[{"inerx", " ", "inery", " ", "inerz", " ", 
        RowBox[{"\[Rho]", "[", "9", "]"}]}]}], 
      RowBox[{"2", " ", "inerx", " ", "inery", " ", "inerz", " ", "m"}]]}], 
    ",", 
    RowBox[{
     RowBox[{"c", "[", "3", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"inery", " ", "inerz", " ", "L", " ", "m", " ", 
        RowBox[{"\[Rho]", "[", "1", "]"}]}], "+", 
       RowBox[{"inerx", " ", "inerz", " ", "L", " ", "m", " ", 
        RowBox[{"\[Rho]", "[", "2", "]"}]}], "+", 
       RowBox[{"inerx", " ", "inery", " ", "m", " ", "\[Lambda]", " ", 
        RowBox[{"\[Rho]", "[", "3", "]"}]}], "-", 
       RowBox[{"inerx", " ", "inery", " ", "inerz", " ", 
        RowBox[{"\[Rho]", "[", "9", "]"}]}]}], 
      RowBox[{"2", " ", "inerx", " ", "inery", " ", "inerz", " ", "m"}]]}], 
    ",", 
    RowBox[{
     RowBox[{"c", "[", "4", "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"inery", " ", "inerz", " ", "L", " ", "m", " ", 
        RowBox[{"\[Rho]", "[", "1", "]"}]}], "-", 
       RowBox[{"inerx", " ", "inerz", " ", "L", " ", "m", " ", 
        RowBox[{"\[Rho]", "[", "2", "]"}]}], "-", 
       RowBox[{"inerx", " ", "inery", " ", "m", " ", "\[Lambda]", " ", 
        RowBox[{"\[Rho]", "[", "3", "]"}]}], "-", 
       RowBox[{"inerx", " ", "inery", " ", "inerz", " ", 
        RowBox[{"\[Rho]", "[", "9", "]"}]}]}], 
      RowBox[{"2", " ", "inerx", " ", "inery", " ", "inerz", " ", "m"}]]}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.953222626121437*^9, 3.953222668165122*^9, 3.9532228692174387`*^9, {
   3.9532231858559227`*^9, 3.953223214146329*^9}, 3.953225259205785*^9, 
   3.953225382355184*^9, 3.9536661474653473`*^9, {3.953668880635441*^9, 
   3.953668895766756*^9}, 3.953671852511361*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"d936534c-58c9-47ff-9a18-c50f56d68336"]
}, Open  ]],

Cell[TextData[{
 "We want to find ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     OverscriptBox["p", "."], "=", 
     FractionBox[
      RowBox[{"-", 
       RowBox[{"\[PartialD]", "H"}]}], 
      RowBox[{"\[PartialD]", "\[Sigma]"}]]}], ",", " ", 
    RowBox[{
    "with", " ", "the", " ", "optimal", " ", "control", " ", "substituted", 
     " ", "in", " ", 
     RowBox[{"H", "."}]}]}], TraditionalForm]],ExpressionUUID->
  "6f338251-7e96-4a2c-a253-f6821a684303"]
}], "Text",
 CellChangeTimes->{{3.953221786210067*^9, 3.95322183695391*^9}, {
  3.95322187290094*^9, 3.9532219295551367`*^9}, {3.953221979349413*^9, 
  3.953221981362599*^9}},ExpressionUUID->"25c1a9b9-a41d-4145-93e2-\
0edc85cdd93f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"optH", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"H", "/.", "optControl"}], ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.953221428368554*^9, 3.95322143246425*^9}, 
   3.953221535239567*^9, {3.9532216739488153`*^9, 3.9532216748016376`*^9}, {
   3.953221728579364*^9, 3.953221759447733*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"31cebc7d-69a1-4945-b7f5-5c9ead175873"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["x", "2"]}], " ", "\[Gamma]"}], "-", 
   RowBox[{
    SuperscriptBox["y", "2"], " ", "\[Gamma]"}], "-", 
   RowBox[{
    SuperscriptBox["z", "2"], " ", "\[Delta]"}], "-", 
   RowBox[{"\[Beta]", " ", 
    SuperscriptBox["\[Theta]", "2"]}], "-", 
   RowBox[{"\[Beta]", " ", 
    SuperscriptBox["\[Phi]", "2"]}], "-", 
   RowBox[{"\[Alpha]", " ", 
    SuperscriptBox["\[Psi]", "2"]}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["L", "2"], " ", 
     SuperscriptBox[
      RowBox[{"\[Rho]", "[", "1", "]"}], "2"]}], 
    SuperscriptBox["inerx", "2"]], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["L", "2"], " ", 
     SuperscriptBox[
      RowBox[{"\[Rho]", "[", "2", "]"}], "2"]}], 
    SuperscriptBox["inery", "2"]], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Lambda]", "2"], " ", 
     SuperscriptBox[
      RowBox[{"\[Rho]", "[", "3", "]"}], "2"]}], 
    SuperscriptBox["inerz", "2"]], "+", 
   RowBox[{"q", " ", 
    RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "4", "]"}]}], "-", 
   RowBox[{"r", " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "5", "]"}]}], "+", 
   RowBox[{"p", " ", 
    RowBox[{"\[Rho]", "[", "6", "]"}]}], "+", 
   RowBox[{"q", " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "6", "]"}]}], "+", 
   RowBox[{"g", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "7", "]"}]}], "+", 
   RowBox[{"g", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "8", "]"}]}], "+", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"\[Rho]", "[", "9", "]"}], "2"], 
    SuperscriptBox["m", "2"]], "+", 
   RowBox[{"u", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
   RowBox[{"v", " ", 
    RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
   RowBox[{"w", " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "10", "]"}]}], "-", 
   RowBox[{"w", " ", 
    RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "11", "]"}]}], "+", 
   RowBox[{"u", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "11", "]"}]}], "+", 
   RowBox[{"v", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "11", "]"}]}], "+", 
   RowBox[{"u", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "12", "]"}]}], "-", 
   RowBox[{"v", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"\[Rho]", "[", "12", "]"}]}], "+", 
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", "g", " ", 
       RowBox[{"\[Rho]", "[", "9", "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", 
          RowBox[{"\[Rho]", "[", "5", "]"}]}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"\[Rho]", "[", "6", "]"}]}], "-", 
         RowBox[{"v", " ", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
         RowBox[{"v", " ", 
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "+", 
      RowBox[{"4", " ", "w", " ", 
       RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
          RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "-", 
      RowBox[{"3", " ", "w", " ", 
       RowBox[{"\[Rho]", "[", "12", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Sec", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "r", " ", 
          RowBox[{"\[Rho]", "[", "4", "]"}]}], "+", 
         RowBox[{"g", " ", 
          RowBox[{"\[Rho]", "[", "9", "]"}]}], "-", 
         RowBox[{"w", " ", 
          RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Tan", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", 
          RowBox[{"\[Rho]", "[", "9", "]"}]}], "+", 
         RowBox[{"w", " ", 
          RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.9532214330244913`*^9, {3.9532215355664463`*^9, 3.95322157044451*^9}, {
   3.953221663224534*^9, 3.953221691859367*^9}, {3.953221745005309*^9, 
   3.953221761790187*^9}, 3.953222615212489*^9, 3.9532226913370113`*^9, 
   3.953222883522407*^9, 3.953223185877412*^9, 3.9532232302615767`*^9, 
   3.953225274243643*^9, 3.953225398101446*^9, {3.953666162687909*^9, 
   3.953666162744865*^9}, 3.9536688806674223`*^9, 3.953668914796979*^9, 
   3.953671861260778*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"23f57122-530b-42a0-8db0-3f8573029863"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"costateDot", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Grad", "[", 
     RowBox[{"optH", ",", " ", "\[Sigma]"}], "]"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.953221984442493*^9, 3.953221991557176*^9}, {
  3.953222247360602*^9, 3.953222290063076*^9}, {3.9532226874191093`*^9, 
  3.9532227414889517`*^9}, {3.95322288824473*^9, 3.953222931622858*^9}, {
  3.953222962861207*^9, 3.953223021942061*^9}, {3.9532231458043213`*^9, 
  3.9532231743124647`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"d8939eb6-bfea-4fd8-880b-8b5505917684"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"\[Rho]", "[", "6", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sec", "[", "\[Theta]", "]"}]}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "4", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "5", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "6", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "5", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Rho]", "[", "4", "]"}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "6", "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"2", " ", "\[Alpha]", " ", "\[Psi]"}], "+", 
     RowBox[{"u", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
     RowBox[{"v", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "10", "]"}]}], "-", 
     RowBox[{"w", " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "11", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"w", " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
        RowBox[{"u", " ", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "11", "]"}]}], "+", 
        RowBox[{"v", " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"w", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
           RowBox[{"v", " ", 
            RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", " ", 
            RowBox[{"\[Rho]", "[", "10", "]"}]}], "-", 
           RowBox[{"w", " ", 
            RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"2", " ", "\[Beta]", " ", "\[Theta]"}], "-", 
     RowBox[{"q", " ", 
      RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "4", "]"}]}], "-", 
     RowBox[{"q", " ", 
      SuperscriptBox[
       RowBox[{"Sec", "[", "\[Theta]", "]"}], "2"], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "6", "]"}]}], "+", 
     RowBox[{"g", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "8", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "11", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "12", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", 
         RowBox[{"\[Rho]", "[", "7", "]"}]}], "+", 
        RowBox[{"v", " ", 
         RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
        RowBox[{"v", " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "11", "]"}]}], "+", 
        RowBox[{"u", " ", 
         RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "r", " ", 
         SuperscriptBox[
          RowBox[{"Sec", "[", "\[Theta]", "]"}], "2"], " ", 
         RowBox[{"\[Rho]", "[", "6", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "g", " ", 
            RowBox[{"\[Rho]", "[", "9", "]"}]}], "-", 
           RowBox[{"4", " ", "w", " ", 
            RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
               RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
               RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "+", 
           RowBox[{"3", " ", "w", " ", 
            RowBox[{"\[Rho]", "[", "12", "]"}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"Tan", "[", "\[Theta]", "]"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"\[Rho]", "[", "9", "]"}]}], "-", 
              RowBox[{"w", " ", 
               RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "w", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
               RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
               RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", "r", " ", 
               RowBox[{"\[Rho]", "[", "4", "]"}]}], "-", 
              RowBox[{"g", " ", 
               RowBox[{"\[Rho]", "[", "9", "]"}]}], "+", 
              RowBox[{"w", " ", 
               RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}]}], ")"}]}]}], 
       ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"2", " ", "\[Beta]", " ", "\[Phi]"}], "-", 
     RowBox[{"q", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "4", "]"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "5", "]"}]}], "-", 
     RowBox[{"q", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "6", "]"}]}], "-", 
     RowBox[{"g", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "8", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "10", "]"}]}], "-", 
     RowBox[{"w", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
     RowBox[{"w", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "11", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "11", "]"}]}], "+", 
     RowBox[{"v", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "12", "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "g", " ", 
         RowBox[{"\[Rho]", "[", "9", "]"}]}], "+", 
        RowBox[{"4", " ", 
         RowBox[{"Sec", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", 
            RowBox[{"\[Rho]", "[", "5", "]"}]}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
            RowBox[{"\[Rho]", "[", "6", "]"}]}], "-", 
           RowBox[{"v", " ", 
            RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
            RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
           RowBox[{"v", " ", 
            RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
            RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", "w", " ", 
         RowBox[{"Tan", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
            RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
            RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "-", 
        RowBox[{"3", " ", "w", " ", 
         RowBox[{"\[Rho]", "[", "12", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Sec", "[", "\[Theta]", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", "r", " ", 
            RowBox[{"\[Rho]", "[", "4", "]"}]}], "+", 
           RowBox[{"g", " ", 
            RowBox[{"\[Rho]", "[", "9", "]"}]}], "-", 
           RowBox[{"w", " ", 
            RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Tan", "[", "\[Theta]", "]"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "g"}], " ", 
            RowBox[{"\[Rho]", "[", "9", "]"}]}], "+", 
           RowBox[{"w", " ", 
            RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"\[Rho]", "[", "10", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "11", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "\[Psi]", "]"}]}], " ", 
         RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "11", "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Phi]", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "10", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Psi]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "11", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
         RowBox[{"\[Rho]", "[", "12", "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{"2", " ", "x", " ", "\[Gamma]"}], ",", 
    RowBox[{"2", " ", "y", " ", "\[Gamma]"}], ",", 
    RowBox[{"2", " ", "z", " ", "\[Delta]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.953221997546783*^9, {3.953222249185843*^9, 3.953222257631365*^9}, 
   3.9532222909610233`*^9, 3.953222615290998*^9, {3.9532227079466457`*^9, 
   3.9532227416906853`*^9}, {3.953222883578364*^9, 3.953222931843664*^9}, {
   3.953222963749939*^9, 3.953223022161756*^9}, 3.953223185896023*^9, 
   3.9532232356521187`*^9, 3.953225279589267*^9, 3.953225403750044*^9, 
   3.953666167544855*^9, 3.953668880701989*^9, 3.9536689215216084`*^9, 
   3.9536718638039618`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"bc8a4b37-e63c-4cc2-af80-065c6ac72888"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\[AliasDelimiter]"], "Input",
 CellChangeTimes->{3.953653131215967*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"f5e69eae-9b71-4b3f-bb67-b4dcd6a10fd4"],

Cell[BoxData["\[AliasDelimiter]"], "Output",
 CellChangeTimes->{3.953668880733748*^9, 3.953668921564891*^9, 
  3.953671863846315*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"c9fe185c-9ea7-49bc-9e51-ed886ea61469"]
}, Open  ]]
},
WindowSize->{1440, 750},
WindowMargins->{{0, Automatic}, {Automatic, 36}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->"/home/matthew/print.pdf"},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1. Inherited,
FrontEndVersion->"13.1 for Linux x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"63bd2e51-c0fe-48b1-a38b-e8754dd8b503"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 500, 14, 36, "Text",ExpressionUUID->"e3ec070d-361b-4d04-bfbc-e7027db82d39"],
Cell[CellGroupData[{
Cell[1083, 38, 404, 7, 29, "Input",ExpressionUUID->"1aba52b7-e0ff-4dc5-9f66-147c5c9af052"],
Cell[1490, 47, 648, 13, 33, "Output",ExpressionUUID->"18742f15-3f08-4a83-8ce2-445a00ce0a5b"]
}, Open  ]],
Cell[2153, 63, 5748, 152, 310, "Input",ExpressionUUID->"e2d9606a-5b72-43d1-9896-da17b6cc5c55"],
Cell[7904, 217, 220, 3, 29, "Input",ExpressionUUID->"3c34ee0f-76a5-44a0-9d24-e40ffd0dd8c6"],
Cell[CellGroupData[{
Cell[8149, 224, 732, 15, 54, "Input",ExpressionUUID->"c3378d7c-7b96-40ee-baa5-ffbd49d0d95c"],
Cell[8884, 241, 998, 21, 33, "Output",ExpressionUUID->"bd012df3-7c10-41d7-a4c8-b97c1b2ae462"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9919, 267, 1323, 31, 33, "Input",ExpressionUUID->"f5e6ae14-8415-46c7-9ffb-80042703e644"],
Cell[11245, 300, 6268, 178, 144, "Output",ExpressionUUID->"4cde519c-5093-450a-b47c-47a90fb9e0a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17550, 483, 411, 10, 29, "Input",ExpressionUUID->"7a871b14-2814-4f15-824c-c42388d84e9d"],
Cell[17964, 495, 3046, 67, 262, "Output",ExpressionUUID->"d936534c-58c9-47ff-9a18-c50f56d68336"]
}, Open  ]],
Cell[21025, 565, 709, 20, 39, "Text",ExpressionUUID->"25c1a9b9-a41d-4145-93e2-0edc85cdd93f"],
Cell[CellGroupData[{
Cell[21759, 589, 468, 10, 29, "Input",ExpressionUUID->"31cebc7d-69a1-4945-b7f5-5c9ead175873"],
Cell[22230, 601, 5975, 156, 161, "Output",ExpressionUUID->"23f57122-530b-42a0-8db0-3f8573029863"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28242, 762, 580, 12, 33, "Input",ExpressionUUID->"d8939eb6-bfea-4fd8-880b-8b5505917684"],
Cell[28825, 776, 14431, 365, 322, "Output",ExpressionUUID->"bc8a4b37-e63c-4cc2-af80-065c6ac72888"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43293, 1146, 164, 2, 29, "Input",ExpressionUUID->"f5e69eae-9b71-4b3f-bb67-b4dcd6a10fd4"],
Cell[43460, 1150, 212, 3, 33, "Output",ExpressionUUID->"c9fe185c-9ea7-49bc-9e51-ed886ea61469"]
}, Open  ]]
}
]
*)

